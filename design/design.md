# 2つのノードでのファイル共有アプリ(P2P)

# 機能
- 自ノードのファイルを一覧で表示する
- 相手ノードのファイルを検索する

# フォルダ構成
- /cmd : main.goなどのエントリポイント
- /client : クライアントサイド
  - /query : クエリ検索用
  - /download : ファイルのダウンロード
- /server : サーバーサイド
  - /search : 自ノードファイル検索
  - /upload : 指定されたファイルのアップロード（クライアントのdownload用）

# 動作
1. ユーザーが欲しいファイルのキーワードを検索
2. 自ノードのファイルを検索（あればファイルパスとともに結果に表示）
3. ない場合は、相手ノードに検索クエリの発行
4. もう一方のノードはキーワードにヒットしたファイル一覧を表示（なければない旨を表示）
5. ファイルを選択してダウンロード
6. 結果にファイルパスを表示

## 1. ユーザーが検索する
- 場所
  - ターミナル
- 検索のやり方
  - `スペース区切り` で３つまで検索ワードを入力する

## 2. 自ノードのファイルを検索
- 検索場所
  - filesフォルダ
- 検索方法
  - [filePath.walkで検索を行う](https://golang.hateblo.jp/entry/golang-file-search-program-for-beginner)

## 3. 相手ノードへの検索クエリの実行
- 検索方法
  - ソケット通信を使った検索クエリの発行（リクエストボディに検索条件を詰め込む）：TCP通信の実装
  - 参考：[GoでたたくTCPソケット（前編）](https://ascii.jp/elem/000/001/276/1276572/)

## 4. ファイル一覧の表示
- 一覧取得方法
  1. 相手ノードからのレスポンスボディ内のファイル一覧を取得
  2. ファイル一覧を表示

      ある場合 : 自ノードか相手ノードか示した上で一覧表示

      ない場合 : `検索結果はありません` と表示

## 5. ファイルを選択し、ダウンロード
- ファイル選択方法
  - ファイル一覧を番号で表示し、ダウンロードしたい番号を選択
  - 選択するものがない場合は0を選択
- ファイルダウンロード
  - サーバー実装
    - リクエストのURI : http://{ホスト名}/download/{file名}
    - fileをzip→byteに変換しレスポンスに含める
  - クライアント実装
    - レスポンスをbyte→zip→ファイルに変換して保存
  - 応用
    - 分割ダウンロードのため[pget](https://github.com/Code-Hex/pget)を使用
    - サーバー側に分割ダウンロード対応のため `Accept-Ranges: bytes` がヘッダーに必要？？

## 6. ファイルパスを表示
-  `ダウンロード完了` の文言とともにファイルパスを表示
